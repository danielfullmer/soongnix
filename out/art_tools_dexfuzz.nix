{ java_library_host, sh_binary_host }:
let

#
#  Copyright (C) 2014 The Android Open Source Project
#
#  Licensed under the Apache License, Version 2.0 (the "License");
#  you may not use this file except in compliance with the License.
#  You may obtain a copy of the License at
#
#       http://www.apache.org/licenses/LICENSE-2.0
#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS,
#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#  See the License for the specific language governing permissions and
#  limitations under the License.
#

#  --- dexfuzz.jar ----------------
dexfuzz = java_library_host {
    name = "dexfuzz";
    srcs = [
        "src/dexfuzz/DexFuzz.java"
        "src/dexfuzz/ExecutionResult.java"
        "src/dexfuzz/Log.java"
        "src/dexfuzz/MutationStats.java"
        "src/dexfuzz/Options.java"
        "src/dexfuzz/StreamConsumer.java"
        "src/dexfuzz/Timer.java"
        "src/dexfuzz/executors/Architecture.java"
        "src/dexfuzz/executors/Arm64InterpreterExecutor.java"
        "src/dexfuzz/executors/Arm64OptimizingBackendExecutor.java"
        "src/dexfuzz/executors/ArmInterpreterExecutor.java"
        "src/dexfuzz/executors/ArmOptimizingBackendExecutor.java"
        "src/dexfuzz/executors/Device.java"
        "src/dexfuzz/executors/Executor.java"
        "src/dexfuzz/executors/X86InterpreterExecutor.java"
        "src/dexfuzz/executors/X86OptimizingBackendExecutor.java"
        "src/dexfuzz/executors/X86_64InterpreterExecutor.java"
        "src/dexfuzz/executors/X86_64OptimizingBackendExecutor.java"
        "src/dexfuzz/fuzzers/Fuzzer.java"
        "src/dexfuzz/fuzzers/FuzzerMultiple.java"
        "src/dexfuzz/fuzzers/FuzzerMultipleExecute.java"
        "src/dexfuzz/fuzzers/FuzzerMultipleNoExecute.java"
        "src/dexfuzz/fuzzers/FuzzerSingle.java"
        "src/dexfuzz/fuzzers/FuzzerSingleExecute.java"
        "src/dexfuzz/fuzzers/FuzzerSingleNoExecute.java"
        "src/dexfuzz/listeners/BaseListener.java"
        "src/dexfuzz/listeners/BisectionSearchListener.java"
        "src/dexfuzz/listeners/ConsoleLoggerListener.java"
        "src/dexfuzz/listeners/FinalStatusListener.java"
        "src/dexfuzz/listeners/LogFileListener.java"
        "src/dexfuzz/listeners/MultiplexerListener.java"
        "src/dexfuzz/listeners/UniqueProgramTrackerListener.java"
        "src/dexfuzz/listeners/UpdatingConsoleListener.java"
        "src/dexfuzz/program/CodeTranslator.java"
        "src/dexfuzz/program/IdCreator.java"
        "src/dexfuzz/program/MBranchInsn.java"
        "src/dexfuzz/program/MInsn.java"
        "src/dexfuzz/program/MInsnWithData.java"
        "src/dexfuzz/program/MSwitchInsn.java"
        "src/dexfuzz/program/MTryBlock.java"
        "src/dexfuzz/program/MutatableCode.java"
        "src/dexfuzz/program/Mutation.java"
        "src/dexfuzz/program/MutationSerializer.java"
        "src/dexfuzz/program/Program.java"
        "src/dexfuzz/program/mutators/ArithOpChanger.java"
        "src/dexfuzz/program/mutators/BranchShifter.java"
        "src/dexfuzz/program/mutators/CmpBiasChanger.java"
        "src/dexfuzz/program/mutators/CodeMutator.java"
        "src/dexfuzz/program/mutators/ConstantValueChanger.java"
        "src/dexfuzz/program/mutators/ConversionRepeater.java"
        "src/dexfuzz/program/mutators/FieldFlagChanger.java"
        "src/dexfuzz/program/mutators/IfBranchChanger.java"
        "src/dexfuzz/program/mutators/InstructionDeleter.java"
        "src/dexfuzz/program/mutators/InstructionDuplicator.java"
        "src/dexfuzz/program/mutators/InstructionSwapper.java"
        "src/dexfuzz/program/mutators/InvokeChanger.java"
        "src/dexfuzz/program/mutators/NewArrayLengthChanger.java"
        "src/dexfuzz/program/mutators/NewInstanceChanger.java"
        "src/dexfuzz/program/mutators/NewMethodCaller.java"
        "src/dexfuzz/program/mutators/NonsenseStringPrinter.java"
        "src/dexfuzz/program/mutators/OppositeBranchChanger.java"
        "src/dexfuzz/program/mutators/PoolIndexChanger.java"
        "src/dexfuzz/program/mutators/RandomBranchChanger.java"
        "src/dexfuzz/program/mutators/RandomInstructionGenerator.java"
        "src/dexfuzz/program/mutators/RegisterClobber.java"
        "src/dexfuzz/program/mutators/SwitchBranchShifter.java"
        "src/dexfuzz/program/mutators/TryBlockShifter.java"
        "src/dexfuzz/program/mutators/VRegChanger.java"
        "src/dexfuzz/program/mutators/ValuePrinter.java"
        "src/dexfuzz/rawdex/AnnotationElement.java"
        "src/dexfuzz/rawdex/AnnotationItem.java"
        "src/dexfuzz/rawdex/AnnotationOffItem.java"
        "src/dexfuzz/rawdex/AnnotationSetItem.java"
        "src/dexfuzz/rawdex/AnnotationSetRefItem.java"
        "src/dexfuzz/rawdex/AnnotationSetRefList.java"
        "src/dexfuzz/rawdex/AnnotationsDirectoryItem.java"
        "src/dexfuzz/rawdex/ClassDataItem.java"
        "src/dexfuzz/rawdex/ClassDefItem.java"
        "src/dexfuzz/rawdex/CodeItem.java"
        "src/dexfuzz/rawdex/DebugInfoItem.java"
        "src/dexfuzz/rawdex/DexRandomAccessFile.java"
        "src/dexfuzz/rawdex/EncodedAnnotation.java"
        "src/dexfuzz/rawdex/EncodedArray.java"
        "src/dexfuzz/rawdex/EncodedArrayItem.java"
        "src/dexfuzz/rawdex/EncodedCatchHandler.java"
        "src/dexfuzz/rawdex/EncodedCatchHandlerList.java"
        "src/dexfuzz/rawdex/EncodedField.java"
        "src/dexfuzz/rawdex/EncodedMethod.java"
        "src/dexfuzz/rawdex/EncodedTypeAddrPair.java"
        "src/dexfuzz/rawdex/EncodedValue.java"
        "src/dexfuzz/rawdex/FieldAnnotation.java"
        "src/dexfuzz/rawdex/FieldIdItem.java"
        "src/dexfuzz/rawdex/HeaderItem.java"
        "src/dexfuzz/rawdex/Instruction.java"
        "src/dexfuzz/rawdex/MapItem.java"
        "src/dexfuzz/rawdex/MapList.java"
        "src/dexfuzz/rawdex/MethodAnnotation.java"
        "src/dexfuzz/rawdex/MethodIdItem.java"
        "src/dexfuzz/rawdex/Offset.java"
        "src/dexfuzz/rawdex/OffsetTracker.java"
        "src/dexfuzz/rawdex/Offsettable.java"
        "src/dexfuzz/rawdex/Opcode.java"
        "src/dexfuzz/rawdex/OpcodeInfo.java"
        "src/dexfuzz/rawdex/ParameterAnnotation.java"
        "src/dexfuzz/rawdex/ProtoIdItem.java"
        "src/dexfuzz/rawdex/RawDexFile.java"
        "src/dexfuzz/rawdex/RawDexObject.java"
        "src/dexfuzz/rawdex/StringDataItem.java"
        "src/dexfuzz/rawdex/StringIdItem.java"
        "src/dexfuzz/rawdex/TryItem.java"
        "src/dexfuzz/rawdex/TypeIdItem.java"
        "src/dexfuzz/rawdex/TypeItem.java"
        "src/dexfuzz/rawdex/TypeList.java"
        "src/dexfuzz/rawdex/formats/AbstractFormat.java"
        "src/dexfuzz/rawdex/formats/ContainsConst.java"
        "src/dexfuzz/rawdex/formats/ContainsPoolIndex.java"
        "src/dexfuzz/rawdex/formats/ContainsTarget.java"
        "src/dexfuzz/rawdex/formats/ContainsVRegs.java"
        "src/dexfuzz/rawdex/formats/Format00x.java"
        "src/dexfuzz/rawdex/formats/Format1.java"
        "src/dexfuzz/rawdex/formats/Format10t.java"
        "src/dexfuzz/rawdex/formats/Format10x.java"
        "src/dexfuzz/rawdex/formats/Format11n.java"
        "src/dexfuzz/rawdex/formats/Format11x.java"
        "src/dexfuzz/rawdex/formats/Format12x.java"
        "src/dexfuzz/rawdex/formats/Format2.java"
        "src/dexfuzz/rawdex/formats/Format20bc.java"
        "src/dexfuzz/rawdex/formats/Format20t.java"
        "src/dexfuzz/rawdex/formats/Format21c.java"
        "src/dexfuzz/rawdex/formats/Format21h.java"
        "src/dexfuzz/rawdex/formats/Format21s.java"
        "src/dexfuzz/rawdex/formats/Format21t.java"
        "src/dexfuzz/rawdex/formats/Format22b.java"
        "src/dexfuzz/rawdex/formats/Format22c.java"
        "src/dexfuzz/rawdex/formats/Format22cs.java"
        "src/dexfuzz/rawdex/formats/Format22s.java"
        "src/dexfuzz/rawdex/formats/Format22t.java"
        "src/dexfuzz/rawdex/formats/Format22x.java"
        "src/dexfuzz/rawdex/formats/Format23x.java"
        "src/dexfuzz/rawdex/formats/Format3.java"
        "src/dexfuzz/rawdex/formats/Format30t.java"
        "src/dexfuzz/rawdex/formats/Format31c.java"
        "src/dexfuzz/rawdex/formats/Format31i.java"
        "src/dexfuzz/rawdex/formats/Format31t.java"
        "src/dexfuzz/rawdex/formats/Format32x.java"
        "src/dexfuzz/rawdex/formats/Format35c.java"
        "src/dexfuzz/rawdex/formats/Format35mi.java"
        "src/dexfuzz/rawdex/formats/Format35ms.java"
        "src/dexfuzz/rawdex/formats/Format3rc.java"
        "src/dexfuzz/rawdex/formats/Format3rmi.java"
        "src/dexfuzz/rawdex/formats/Format3rms.java"
        "src/dexfuzz/rawdex/formats/Format5.java"
        "src/dexfuzz/rawdex/formats/Format51l.java"
        "src/dexfuzz/rawdex/formats/RawInsnHelper.java"
    ];
    manifest = "manifest.txt";
};

#  --- dexfuzz script ----------------
dexfuzz-script = sh_binary_host {
    name = "dexfuzz-script";
    src = "dexfuzz";
    filename_from_src = true;
};

in { inherit dexfuzz dexfuzz-script; }
